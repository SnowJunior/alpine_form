<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://unpkg.com/alpinejs" defer></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Wala Form</title>
    <style>
      .drop-zone {
        border: 2px dashed #ccc;
        border-radius: 6px;
        padding: 50px;
        text-align: center;
        cursor: pointer;
      }
      .drop-zone.dragover {
        border-color: #333;
        background-color: #f9f9f9;
      }
    </style>
  </head>
  <body>
    <div class="w-[40%] mx-auto h-screen mt-8 flex flex-col items-center">
      <h2 class="font-bold text-lg text-black text-center uppercase my-4">
        Wala
      </h2>

      <div
        class="flex flex-col border border-[1px] border-black w-full h-fit rounded-lg px-6 py-6"
      >
        <h3 class="text-black text-center text-base my-4">Form Data</h3>

        <form class="flex flex-col" id="file-form">
          <label for="file_name" class="text-base text-black">File name:</label>
          <input
            type="text"
            class="border border-black border-[1px] rounded h-12 px-3 mt-2"
            id="file_name"
            name="file_name"
          />

          <label for="file" class="mt-3 mb-2">Enter file</label>
          <input type="file" id="file" class="hidden" name="file" />
          <div class="drop-zone" id="drop-zone">
            Drag & Drop file here or click to upload
          </div>

          <button
            type="submit"
            class="mt-7 h-14 bg-black text-white py-2 rounded"
          >
            Submit
          </button>
        </form>
      </div>
    </div>

    <script>
      const dropZone = document.getElementById("drop-zone");
      const fileInput = document.getElementById("file");
      const fileForm = document.getElementById("file-form");

      dropZone.addEventListener("click", () => fileInput.click());

      fileInput.addEventListener("change", () => {
        if (fileInput.files.length) {
          dropZone.textContent = fileInput.files[0].name;
        }
      });

      dropZone.addEventListener("dragover", (e) => {
        e.preventDefault();
        dropZone.classList.add("dragover");
      });

      dropZone.addEventListener("dragleave", () => {
        dropZone.classList.remove("dragover");
      });

      dropZone.addEventListener("drop", (e) => {
        e.preventDefault();
        dropZone.classList.remove("dragover");
        if (e.dataTransfer.files.length) {
          fileInput.files = e.dataTransfer.files;
          dropZone.textContent = e.dataTransfer.files[0].name;
        }
      });

      fileForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const formData = new FormData(fileForm);
        const payload = {
          file_name: formData.get("file_name"),
          file: formData.get("file"),
        };

        fetch("http://localhost:8080", {
          method: "PUT",
          headers: {
            "Content-Type": "multipart/form-data",
          },
          body: JSON.stringify(payload),
        })
          .then((response) => response.json())
          .then((data) => {
            console.log("Success:", data);
          })
          .catch((error) => {
            console.error("Error:", error);
          });
      });
    </script>
  </body>
</html>
